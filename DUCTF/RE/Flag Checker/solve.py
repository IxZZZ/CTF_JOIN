# offset_v8 = 0x56503ad312a0
# offset_v9 = 0x56503ad33ab0


# arr = []
# for i in range(0x1f8):
#     b = ida_bytes.get_bytes(offset_v8+8*i, 8)
#     i_b = int.from_bytes(b, byteorder='little')
#     if i_b != 0:
#         arr.append(i_b-offset_v9)

# print(arr)

arr_save_pos = [144, 288, 784, 880, 1056, 1088, 1456, 1552, 1776, 1984, 2144, 2448, 2512, 2608, 2672, 3008, 3040, 3104, 3296, 4016, 4176, 4576, 4608, 4704, 4880, 4912, 5408, 5504, 5664, 5824, 5968, 6208, 6432, 7152, 7232, 7488, 7712, 8000, 8064, 8224, 8864, 9008, 9776, 10032, 10160, 10992, 11408, 11504, 11904, 11936, 12016, 12048, 12080, 12112, 12176, 12208, 12288, 12320, 12352, 12384, 12448, 12512, 12544, 12576, 12640, 12672, 12704, 12768, 12800, 12832, 12912, 12944, 12976, 13008, 13072, 13104, 13168, 13200, 13232, 13312, 13344, 13376, 13408, 13472, 13504, 13536, 13600, 13680, 13712, 13744, 13776, 13840, 13872, 13904, 13968, 14032, 14064, 14128, 14192, 14224, 14256, 14320, 14384, 14416, 14448, 14512, 14544, 14608, 14640, 14704, 14736, 14800, 14832, 14864, 14928, 15008, 15040, 15072, 15104, 15168, 15200, 15232, 15296, 15376, 15408, 15440, 15472, 15536, 15568, 15600, 15664, 15728, 15792, 15856, 15888, 15920, 15984, 16016, 16048, 16112, 16176, 16208, 16240, 16304, 16368, 16448, 16480, 16512, 16544, 16608,
                16688, 16720, 16752, 16784, 16848, 16880, 16944, 16976, 17008, 17088, 17120, 17152, 17184, 17248, 17280, 17344, 17376, 17408, 17472, 17536, 17568, 17632, 17696, 17728, 17792, 17824, 17856, 17920, 17952, 18016, 18048, 18080, 18144, 18176, 18208, 18288, 18320, 18352, 18384, 18448, 18480, 18512, 18576, 18608, 18640, 18704, 18736, 18768, 18832, 18864, 18928, 18960, 19024, 19104, 19136, 19168, 19200, 19280, 19312, 19344, 19376, 19440, 19472, 19552, 19584, 19616, 19648, 19712, 19776, 19808, 19872, 19936, 19968, 20032, 20064, 20128, 20192, 20224, 20256, 20320, 20352, 20384, 20448, 20480, 20512, 20576, 20608, 20688, 20720, 20752, 20784, 20864, 20896, 20928, 20960, 21024, 21088, 21152, 21184, 21248, 21280, 21312, 21376, 21408, 21472, 21536, 21600, 21632, 21664, 21728, 21808, 21840, 21872, 21904, 21968, 22032, 22096, 22128, 22192, 22256, 22288, 22320, 22384, 22416, 22448, 22512, 22576, 22608, 22640, 22720, 22752, 22784, 22816, 22880, 22944, 22976, 23008, 23072, 23104, 23168, 23200, 23232, 23296, 23328, 23392, 23424]


def cal_const(con):
    return (con*152400177+1148817425) & 0xffffffff


con = 0x4616DC37

map_index = {}


for i in range(len(arr_save_pos)):
    con = cal_const(con)
    map_index[arr_save_pos[i]] = con % 0x24

# print(map_index)


arr_map_to_final = [10032, 23296, 880, 1776,
                    12576, 13168, 13008, 22448, 11936, 5968, 1088, 1456, 19344, 784, 12048, 19136, 7152, 13968, 5504, 5664, 17536, 13600, 6208, 7712, 4912, 18640, 7488, 14640, 12208, 10160, 23424, 12080, 8000, 19200, 13904, 12016]

print(len(arr_map_to_final))

arr_value = []

final_val = [15, 79, 115, 60, 65, 198, 164, 175, 180, 65, 214, 101, 200, 153, 170, 179,
             108, 153, 97, 60, 78, 221, 112, 70, 21, 102, 60, 27, 127, 22, 166, 111, 35, 19, 18, 110]


map_val = [0]*36
# print(map_val)
swap = []
for i in range(len(arr_map_to_final)):
    map_val[map_index[arr_map_to_final[i]]] = final_val[i]
    swap.append(map_index[arr_map_to_final[i]])

print(map_val)

print(swap)
